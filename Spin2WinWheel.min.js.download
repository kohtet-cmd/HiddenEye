function Spin2WinWheel(){var t,e,n,i,r,o,l,a,s,u,c,d,h,g,f,p,S,m,w,b,v,x,y,T,N,A,M,k,C,E,O,P,I,B,R,D,G,z,V="http://www.w3.org/2000/svg",W=function(t){return document.querySelector(t)},_=this,L=W(".wheelSVG"),H=W(".wheel"),U=W(".wheelOutline"),Y=W(".peg"),q=W(".pegContainer"),F=W(".mainContainer"),J=W(".valueContainer"),X=W(".centerCircle"),j=W(".toast"),K=W(".toast p"),Q=0,Z=0,$=2,tt=0,et=0,nt=et,it=[],rt=null,ot=[],lt=new Audio("/sites/default/files/wheel_tick.mp3"),at=!0,st=function(){TweenMax.set("svg",{visibility:"visible"}),TweenMax.set(H,{svgOrigin:A+" "+M,x:0,y:0}),TweenMax.set(Y,{x:A-Y.getBBox().width/20+13,y:M-r-Y.getBBox().height/6,transformOrigin:"50% 25%",visibility:"visible"}),TweenMax.set(q,{transformOrigin:"50% 100%",scale:i/600}),TweenMax.set(F,{svgOrigin:A+" "+M,rotation:-90,x:0,y:0}),TweenMax.set([j],{xPercent:-50,left:"50%",top:"50%",yPercent:-50}),TweenMax.set("svg",{xPercent:-50,left:"50%",top:"50%",yPercent:-50})},ut=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},ct=function(){for(var t=0;t<v;t++){var e=document.createElementNS(V,"line");e.setAttributeNS(null,"x1",A),e.setAttributeNS(null,"x2",it[t].x2),e.setAttributeNS(null,"y1",M),e.setAttributeNS(null,"y2",it[t].y2),e.setAttributeNS(null,"stroke",m),e.setAttributeNS(null,"stroke-width",w),H.appendChild(e),TweenMax.set(e,{svgOrigin:A+" "+M,rotation:t*y})}},dt=function(){for(var t=0;t<v;t++){var e=document.createElementNS(V,"g");if("image"==b[t].type){var n=document.createElementNS(V,"image");e.appendChild(n),n.setAttribute("class","wheelImage"),n.setAttributeNS(null,"x",A-u/2),n.setAttributeNS(null,"y",M-r+a),n.setAttributeNS(null,"width",u),n.setAttributeNS(null,"height",u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",b[t].value)}else if("string"==b[t].type){var i=document.createElementNS(V,"text"),c=document.createTextNode(b[t].value);i.appendChild(c),e.appendChild(i),i.setAttribute("class","wheelText"),i.setAttributeNS(null,"fill",o),i.setAttributeNS(null,"x",A),i.setAttributeNS(null,"y",M-r+l),i.style.fontSize=s}J.appendChild(e),TweenMax.set(e,{svgOrigin:A+" "+M,rotation:t*y})}TweenMax.set(J,{svgOrigin:A+" "+M})},ht=function(){lt.play()},gt=function(){j.style.visibility="hidden"},ft=function(){j.style.visibility="hidden",rt.onclick=null,$+=2},pt=function(){Tt(),at&&(G=VelocityTracker.track(H,"rotation"))},St=function(t){if(N=Q,(Q=Math.round(H._gsTransform.rotation/y))!=N){var e=Q>N?-35:35;TweenMax.fromTo(Y,.2,{rotation:e},{onStart:B?ht:null,rotation:0,ease:Back.easeOut})}TweenMax.set(J,{rotation:H._gsTransform.rotation})},mt=function(){d=H._gsTransform.rotation;var t=Math.round(d%360);if(t=(t=t>0?360-t:t)<0?t*=-1:t,G&&G.getVelocity("rotation")<=.5)return Nt(),void At("invalidSpin");var e=Math.round(t/y);it[e].path;if(At(Math.abs(e)),at){if(!(x>-1))return;Z++}else Z++,c[0].vars.snap=[z[Z]];VelocityTracker.untrack(H),Z>=x?yt():Nt()},wt=function(){var t;c=Draggable.create(H,{type:"rotation",bounds:{minRotation:-1e16,maxRotation:0},throwProps:!0,ease:Back.easeOut.config(.2),snap:at?(t=0,function(e){return Math.round(e/y)*y-t}):[z[Z]],throwResistance:0,minDuration:C,onThrowComplete:mt,onPress:gt,onDrag:St,onThrowUpdate:St,overshootTolerance:1,onDragEnd:pt})},bt=function(){rt?rt.onclick=vt():(rt=H,H.onclick=vt())},vt=function(){return function(){ThrowPropsPlugin.to(H,{throwProps:{rotation:{velocity:ut(-700,-500),end:at?-y*ut(0,v)-1080*$:[z[Z]]}},onStart:ft,onUpdate:St,ease:Back.easeOut.config(.2),overshootTolerance:0,onComplete:xt})}},xt=function(){d=H._gsTransform.rotation;var t=Math.round(d%360);t=(t=t>0?360-t:t)<0?t*=-1:t;var e=Math.round(t/y);it[e].path;if(At(Math.abs(e)),at){if(!(x>-1))return;Z++}else Z++;Z>=x?yt():rt.onclick=vt()},yt=function(){Tt(),TweenMax.set(L,{alpha:.3}),TweenMax.to(K,1,{text:E,ease:Linear.easeNone,delay:2}),Ot({gameId:I,target:_,results:ot})},Tt=function(){D||c[0].disable()},Nt=function(){D||c[0].enable()},At=function(t){var e;if(D||c[0].applyBounds({minRotation:-1e16,maxRotation:d}),"invalidSpin"==t)return TweenMax.set(H,{rotation:z[Z]}),kt(O),Et(e={target:_,type:"error",spinCount:Z,win:null,msg:O,gameId:I}),void ot.push(e);if(!isNaN(t)){var n=b[t].resultText;kt(n),e={target:_,type:"result",spinCount:Z,win:b[t].win,msg:b[t].resultText,gameId:I},Ct(e),ot.push(e)}},Mt=function(t){kt(t)},kt=function(t){j.style.visibility="visible",j.style.backgroundColor="#E81D62",K.innerHTML=t,TweenMax.fromTo(j,.6,{y:20,display:"none"},{y:0,delay:.2,display:"block",ease:Elastic.easeOut.config(.7,.7)})},Ct=function(t){_.onResult(t)},Et=function(t){_.onError(t)},Ot=function(t){_.onGameEnd(t)};this.onResult=Ct,this.onError=Et,this.onGameEnd=Ot,this.getGameProgress=function(){return ot},this.init=function(c){if(!c)return st(),void Mt("PLEASE INCLUDE THE INIT OBJECT");var d,N;L.setAttribute("viewBox","0 0 "+c.data.svgWidth+" "+c.data.svgHeight),t=c.data,Ot=c.onGameEnd?c.onGameEnd:_.onGameEnd,Ct=c.onResult?c.onResult:_.onResult,Et=c.onError?c.onError:_.onError,(rt=c.spinTrigger?c.spinTrigger:null)&&(D=!0),D&&(rt?rt.onclick=vt():H.onclick=vt()),e=t.wheelStrokeColor,i=t.wheelSize,r=i/2,o=t.wheelTextColor,e=t.wheelStrokeColor,n=t.wheelStrokeWidth,l=t.wheelTextOffsetY,a=t.wheelImageOffsetY,u=t.wheelImageSize,s=t.wheelTextSize,h=t.centerCircleStrokeColor,g=t.centerCircleStrokeWidth,f=t.centerCircleFillColor,p=t.centerCircleSize,S=p/2,m=t.segmentStrokeColor,w=t.segmentStrokeWidth,b=t.segmentValuesArray,v=b.length,x=-1==t.numSpins?1e16:t.numSpins,C=t.minSpinDuration,E=t.gameOverText,O=t.invalidSpinText,P=t.introText,B=t.hasSound,I=t.gameId,D=t.clickToSpin,T=(y=360/v)/2,A=t.centerX,M=t.centerY,k=t.colorArray,R=t.hasShadows,z=t.spinDestinationArray,R&&(U.setAttributeNS(null,"filter","url(#shadow)"),J.setAttributeNS(null,"filter","url(#shadow)"),X.setAttributeNS(null,"filter","url(#shadow)"),q.setAttributeNS(null,"filter","url(#shadow)"),j.style.boxShadow="0px 0px 20px rgba(21,21,21,0.5)"),st(),function(){for(var t,e,n,i,o,l,a,s,u=0;u<v;u++)nt=(et=-T)+y,t=A+r*Math.cos(Math.PI*et/180),n=M+r*Math.sin(Math.PI*et/180),e=A+r*Math.cos(Math.PI*nt/180),i=M+r*Math.sin(Math.PI*nt/180),o="M"+A+","+M+"  L"+t+","+n+"  A"+r+","+r+" 0 0,1 "+e+","+i+"z",a=document.createElementNS(V,"g"),l=document.createElementNS(V,"path"),a.appendChild(l),H.appendChild(a),TweenMax.set(l,{rotation:u*y,svgOrigin:A+" "+M}),l.setAttributeNS(null,"d",o),k[u]?s=k[u]:(s=k[tt],++tt==k.length&&(tt=0)),l.setAttributeNS(null,"fill",s),l.setAttributeNS(null,"stroke",0),it.push({path:l,x1:t,x2:e,y1:n,y2:i});w>0&&ct(),dt()}(),U.appendChild((d=document.createElementNS(V,"g"),N=document.createElementNS(V,"circle"),U.appendChild(d),N.setAttributeNS(null,"fill","transparent"),N.setAttributeNS(null,"stroke",e),N.setAttributeNS(null,"stroke-width",n),N.setAttributeNS(null,"cx",A),N.setAttributeNS(null,"cy",M),N.setAttributeNS(null,"r",r),d.appendChild(N),d)),X.appendChild(function(){var t=document.createElementNS(V,"circle");return t.setAttributeNS(null,"fill",f),t.setAttributeNS(null,"stroke",h),t.setAttributeNS(null,"stroke-width",g),t.setAttributeNS(null,"cx",A),t.setAttributeNS(null,"cy",M),t.setAttributeNS(null,"r",S),t}()),function(){if(z.length>0){at=!1,x=z.length;for(var t=0;t<z.length;t++){if(z[t]>v||0===z[t])return Mt("Invalid destination set - please ensure the destination in spinDestinationArray is greater than 0 and less than or equal to the number of segments"),TweenMax.set(L,{visibility:"hidden"}),void(j.style.backgroundColor="red");z[t]=z[t]-1,z[t]=-1*z[t]*y-1080*$,$+=2}}D?bt():wt()}(),v<=1&&(Mt("Not enough segments. Please add more entries to segmentValuesArray"),TweenMax.set(L,{visibility:"hidden"}),j.style.backgroundColor="red")},this.restart=function(){c[0].kill(),j.style.visibility="hidden",Z=0,$=2,ot=[],Q=N=null,TweenMax.set(L,{alpha:1}),TweenMax.to([H,J],.3,{rotation:"0_short",onComplete:wt}),kt(P)}}